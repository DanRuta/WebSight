<!DOCTYPE html>
<html>
<head>
    <title>Sobel sight</title>
    <script src="dist/sobel-sight-js.concat.js"></script>
    <style>
    body {
        margin: 0;
        overflow: hidden;
    }
    </style>
    <script>
    "use strict"
    window.addEventListener("load", () => {

        const sobel = new Sobel()
        const canvas = document.createElement("canvas")

        const setSize = () => {
            sobel.setSize()
            canvas.width = sobel.width
            canvas.height = sobel.height
            canvas.style.width = 2*canvas.width+"px"
            canvas.style.height = 2*canvas.height+"px"
        }

        sobel.video.onplaying = () => {
            setSize()
            document.body.appendChild(canvas)

            const context = canvas.getContext("2d")

            const capture = () => {
                requestAnimationFrame(capture)
                context.drawImage(sobel.video, 0, 0, canvas.width, canvas.height)
                sobel.convolve(context)
            }
            capture()


            canvas.addEventListener("click", () => {
                document.fullscreenEnabled && canvas.requestFullScreen() ||
                document.webkitFullscreenEnabled && canvas.webkitRequestFullScreen() ||
                document.mozFullScreenEnabled && canvas.mozRequestFullScreen() ||
                document.msFullScreenEnabled && canvas.msRequestFullScreen()
            })
            window.addEventListener("resize", setSize)
        }

        sobel.record()
    })
    </script>
</head>
<body>
</body>
</html>