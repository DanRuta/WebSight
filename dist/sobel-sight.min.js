"use strict";const degToRad=x=>x*Math.PI/180;window.addEventListener("load",()=>{const video=document.createElement("video");if(video.onplaying=(()=>{video.width=window.innerWidth/2,video.height=window.innerHeight/2;const boxWidth=video.width,boxHeight=video.height,renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0});renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(renderer.domElement);let effect=new THREE.VREffect(renderer);effect.separation=0,effect.setSize(window.innerWidth,window.innerHeight);let vrDisplay;navigator.getVRDisplays().then(displays=>displays.length&&(vrDisplay=displays[0]));VRSamplesUtil.addButton("Enter VR","E","/images/cardboard64.png",()=>{navigator.userAgent.includes("Mobile VR")?vrDisplay.requestPresent([{source:renderer.domElement}]):((effect=new THREE.StereoEffect(renderer)).separation=0,effect.setSize(window.innerWidth,window.innerHeight),document.getElementById("vr-sample-button-container").style.display="none")});const scene=new THREE.Scene,camera=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,1e3);camera.position.z=.5*boxWidth*Math.atan(degToRad(55))+100,scene.add(camera);const boxGeometry=new THREE.BoxGeometry(boxWidth,boxHeight,1),texture=new THREE.Texture(video);texture.minFilter=THREE.NearestFilter;const boxMaterial=new THREE.ShaderMaterial({uniforms:{texture:{type:"t",value:texture},width:{type:"f",value:video.width},height:{type:"f",value:video.height}},vertexShader:vertexShaderSource.text,fragmentShader:fragmentShaderSource.text}),box=new THREE.Mesh(boxGeometry,boxMaterial);scene.add(box);const render=()=>{requestAnimationFrame(render),texture.needsUpdate=!0,effect.render(scene,camera)};render(),window.location.href.includes("localhost")||renderer.domElement.addEventListener("click",()=>{(new NoSleep).enable(),document.fullscreenEnabled&&renderer.domElement.requestFullScreen()||document.webkitFullscreenEnabled&&renderer.domElement.webkitRequestFullScreen()||document.mozFullScreenEnabled&&renderer.domElement.mozRequestFullScreen()||document.msFullScreenEnabled&&renderer.domElement.msRequestFullScreen()}),window.addEventListener("resize",()=>{effect.setSize(window.innerWidth,window.innerHeight),camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix()})}),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)navigator.mediaDevices.getUserMedia({video:!0}).then(stream=>{video.src=window.URL.createObjectURL(stream),video.play()}).catch(err=>{console.log(err),alert("There was an error accessing the camera")});else{const getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;getUserMedia?getUserMedia({video:!0},stream=>{video.src=window.URL.createObjectURL(stream),video.play()},err=>{console.log(err),alert("There was an error accessing the camera")}):alert("Camera not available")}});
//# sourceMappingURL=sobel-sight.min.js.map