"use strict";var degToRad=function(x){return x*Math.PI/180};window.addEventListener("load",function(){window.video=document.createElement("video"),video.autoplay=!0,video.width=window.innerWidth/2,video.height=window.innerHeight/2;var boxWidth=video.width,boxHeight=video.height,renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0});renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(renderer.domElement),renderer.domElement.style.backgroundColor="black";var effect=new THREE.VREffect(renderer);effect.separation=0,effect.setSize(window.innerWidth,window.innerHeight);var vrDisplay=void 0;navigator.getVRDisplays&&navigator.getVRDisplays().then(function(displays){return displays.length&&(vrDisplay=displays[0])});VRSamplesUtil.addButton("Enter VR","E","/images/cardboard64.png",function(){navigator.userAgent.includes("Mobile VR")?vrDisplay.requestPresent([{source:renderer.domElement}]):((effect=new THREE.StereoEffect(renderer)).separation=0,effect.setSize(window.innerWidth,window.innerHeight),document.getElementById("vr-sample-button-container").style.display="none")});var scene=new THREE.Scene,camera=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,1e3);camera.position.z=.5*boxWidth*Math.atan(degToRad(55))+100,scene.add(camera);var boxGeometry=new THREE.BoxGeometry(boxWidth,boxHeight,1),texture=new THREE.Texture(video);texture.minFilter=THREE.NearestFilter;var boxMaterial=new THREE.ShaderMaterial({uniforms:{texture:{type:"t",value:texture},width:{type:"f",value:video.width},height:{type:"f",value:video.height}},vertexShader:vertexShaderSource.text,fragmentShader:fragmentShaderSource.text}),box=new THREE.Mesh(boxGeometry,boxMaterial);scene.add(box);!function render(){requestAnimationFrame(render),video.currentTime&&(texture.needsUpdate=!0),effect.render(scene,camera)}(),window.location.href.includes("localhost")||renderer.domElement.addEventListener("click",function(){document.fullscreenEnabled&&renderer.domElement.requestFullScreen()||document.webkitFullscreenEnabled&&renderer.domElement.webkitRequestFullScreen()||document.mozFullScreenEnabled&&renderer.domElement.mozRequestFullScreen()||document.msFullScreenEnabled&&renderer.domElement.msRequestFullScreen()}),window.addEventListener("resize",function(){effect.setSize(window.innerWidth,window.innerHeight),camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix()});try{if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then(function(stream){video.src=window.URL.createObjectURL(stream),video.play()}).catch(function(err){console.log(err),alert("There was an error accessing the camera. Please try again and ensure you are using https")});else{var getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;getUserMedia?getUserMedia({video:{facingMode:"environment"}},function(stream){video.src=window.URL.createObjectURL(stream),video.play()},function(err){console.log(err),alert("There was an error accessing the camera. Please try again and ensure you are using https.")}):alert("Camera not available")}}catch(e){alert("Error getting camera feed. Please ensure you are using https.")}});
//# sourceMappingURL=sobel-sight.min.js.map