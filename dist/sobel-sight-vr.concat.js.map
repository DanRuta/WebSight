{"version":3,"sources":["../dev/js/sobel-vr.js"],"names":[],"mappings":"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","file":"sobel-sight-vr.concat.js","sourcesContent":["\"use strict\"\r\n\r\nconst degToRad = x => x * Math.PI / 180\r\n\r\nwindow.addEventListener(\"load\", () => {\r\n\r\n    window.sobel = new Sobel()\r\n    sobel.record()\r\n\r\n    sobel.video.onplaying = () => {\r\n\r\n        sobel.setSize()\r\n\r\n        const fov = 70\r\n        const boxWidth = sobel.width // window.innerWidth\r\n        const boxHeight = sobel.height // window.innerHeight\r\n\r\n        // Renderer and VR stuff\r\n        const renderer = new THREE.WebGLRenderer({antialias: true, alpha: true}) // Maybe no antialiasing for fps? Needs testing\r\n        renderer.setSize(window.innerWidth, window.innerHeight)\r\n        document.body.appendChild(renderer.domElement)\r\n\r\n        let effect = new THREE.VREffect(renderer)\r\n        effect.separation = 0\r\n        effect.setSize(window.innerWidth, window.innerHeight)\r\n\r\n        let vrDisplay\r\n        navigator.getVRDisplays().then(displays => displays.length && (vrDisplay = displays[0]))\r\n\r\n        // Button to enable VR mode\r\n        const vrButton = VRSamplesUtil.addButton(\"Enter VR\", \"E\", \"/images/cardboard64.png\", () => {\r\n\r\n            if (navigator.userAgent.includes(\"Mobile VR\")) {\r\n                vrDisplay.requestPresent([{source: renderer.domElement}])\r\n            } else {\r\n                effect = new THREE.StereoEffect(renderer)\r\n                effect.separation = 0\r\n                effect.setSize(window.innerWidth, window.innerHeight)\r\n                document.getElementById(\"vr-sample-button-container\").style.display = \"none\"\r\n            }\r\n        })\r\n\r\n        // Scenes and camera\r\n        const scene = new THREE.Scene()\r\n        const camera = new THREE.PerspectiveCamera(fov, window.innerWidth / window.innerHeight, 1, 1000)\r\n        camera.position.z = 0.5 * boxWidth * Math.atan(degToRad(90 - fov / 2)) + 100\r\n        // camera.position.z = 700\r\n        scene.add(camera)\r\n        camera.rotation.order = \"YXZ\"\r\n\r\n        // Canvases and textures\r\n        const textureCanvas = document.createElement(\"canvas\")\r\n        textureCanvas.height = boxHeight\r\n        textureCanvas.width = boxWidth\r\n        const textureContext = textureCanvas.getContext(\"2d\")\r\n\r\n        const texture = new THREE.Texture(textureCanvas)\r\n\r\n\r\n            // TEMP\r\n            textureContext.rect(0,0, textureCanvas.width, textureCanvas.height)\r\n            textureContext.fillStyle = \"pink\"\r\n            textureContext.fill()\r\n\r\n            textureContext.beginPath()\r\n            textureContext.moveTo(0, 0)\r\n            textureContext.strokeStyle = \"orange\"\r\n            textureContext.lineTo(textureCanvas.width, textureCanvas.height)\r\n            textureContext.lineWidth = 10\r\n            textureContext.stroke()\r\n\r\n\r\n\r\n\r\n        // Box object\r\n        const boxGeometry = new THREE.BoxGeometry(boxWidth, boxHeight, 1)\r\n        const boxMaterial = new THREE.MeshBasicMaterial({map: texture})\r\n        const box = new THREE.Mesh(boxGeometry, boxMaterial)\r\n        box.rotation.order = \"YXZ\"\r\n        scene.add(box)\r\n\r\n        // Set minFilter value, to resolve the power of two issue\r\n        texture.minFilter = THREE.NearestFilter\r\n\r\n\r\n        // Render loop\r\n        // ===========\r\n        const render = () => {\r\n            requestAnimationFrame(render)\r\n\r\n            textureContext.drawImage(sobel.video, 0, 0, sobel.video.width, sobel.video.height)\r\n\r\n            sobel.convolve(textureContext)\r\n\r\n            texture.needsUpdate = true\r\n\r\n\r\n            effect.render(scene, camera)\r\n        }\r\n        render()\r\n\r\n        // Do fullscreen + prevent the display from going to sleep when tapped\r\n        if (!window.location.href.includes(\"localhost\")) {\r\n\r\n            renderer.domElement.addEventListener(\"click\", () => {\r\n\r\n                new NoSleep().enable()\r\n\r\n                document.fullscreenEnabled && renderer.domElement.requestFullScreen() ||\r\n                document.webkitFullscreenEnabled && renderer.domElement.webkitRequestFullScreen() ||\r\n                document.mozFullScreenEnabled && renderer.domElement.mozRequestFullScreen() ||\r\n                document.msFullScreenEnabled && renderer.domElement.msRequestFullScreen()\r\n            })\r\n        }\r\n\r\n        // Resizing\r\n        window.addEventListener(\"resize\", () => {\r\n            effect.setSize(window.innerWidth, window.innerHeight)\r\n            camera.aspect = window.innerWidth / window.innerHeight\r\n            camera.updateProjectionMatrix()\r\n        })\r\n\r\n    }\r\n})\r\n"]}